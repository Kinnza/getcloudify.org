machine:
  hosts:
    getcloudify.org: 127.0.0.1

test:
  pre:
    - cd source && bundle exec jekyll build:
        timeout: 600
  override:
    - cd source && bundle exec jekyll doctor
    - cd source/_site ; sudo -E python -mSimpleHTTPServer 80:
       background: true
    - sleep 3
    - linkchecker http://getcloudify.org/guide/ --anchors --no-status --ignore-url=guide/2.7 --ignore-url=^mailto

deployment:
  production:
    branch: master
    commands:
      - bundle exec s3_website push 
